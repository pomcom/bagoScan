package services

import (
	"fmt"

	"github.com/pomcom/bagoScan/pkg/utils/config"
)

type PentestService struct {
	configHandler config.ConfigHandler
	runner        *utils.TestRunner
}

func (s PentestService) RunScan(target string) error {
	config, err := s.configHandler.ReadConfig()
	if err != nil {
		return err
	}
	tools := config.Tools
	s.runner = utils.NewTestRunner(tools)
	outputs := s.runner.Run(target)

	for _, output := range outputs {
		fmt.Println(output.ToolName + ": " + output.Result)
	}
	return nil
}

func NewPentestService(configPath string) *PentestService {
	configHandler := config.NewConfigHandler(configPath)
	return &PentestService{configHandler: configHandler}
}
